/* source_gutter_renderer_folding.c generated by valac 0.44.0, the Vala compiler
 * generated from source_gutter_renderer_folding.vala, do not modify */

#include <gtksourceview/gtksource.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <glib.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gtk/gtk.h>
#include <gdk/gdk.h>
#include <cairo.h>
#include <glib/gi18n-lib.h>

#define VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING (vala_develop_source_gutter_renderer_folding_get_type ())
#define VALA_DEVELOP_SOURCE_GUTTER_RENDERER_FOLDING(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING, valaDevelopSourceGutterRendererFolding))
#define VALA_DEVELOP_SOURCE_GUTTER_RENDERER_FOLDING_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING, valaDevelopSourceGutterRendererFoldingClass))
#define VALA_DEVELOP_IS_SOURCE_GUTTER_RENDERER_FOLDING(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING))
#define VALA_DEVELOP_IS_SOURCE_GUTTER_RENDERER_FOLDING_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING))
#define VALA_DEVELOP_SOURCE_GUTTER_RENDERER_FOLDING_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING, valaDevelopSourceGutterRendererFoldingClass))

typedef struct _valaDevelopSourceGutterRendererFolding valaDevelopSourceGutterRendererFolding;
typedef struct _valaDevelopSourceGutterRendererFoldingClass valaDevelopSourceGutterRendererFoldingClass;
typedef struct _valaDevelopSourceGutterRendererFoldingPrivate valaDevelopSourceGutterRendererFoldingPrivate;
enum  {
	VALA_DEVELOP_SOURCE_GUTTER_RENDERER_FOLDING_0_PROPERTY,
	VALA_DEVELOP_SOURCE_GUTTER_RENDERER_FOLDING_NUM_PROPERTIES
};
static GParamSpec* vala_develop_source_gutter_renderer_folding_properties[VALA_DEVELOP_SOURCE_GUTTER_RENDERER_FOLDING_NUM_PROPERTIES];
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define __vala_GdkEventButton_free0(var) ((var == NULL) ? NULL : (var = (_vala_GdkEventButton_free (var), NULL)))
#define __vala_GdkEvent_free0(var) ((var == NULL) ? NULL : (var = (_vala_GdkEvent_free (var), NULL)))

struct _valaDevelopSourceGutterRendererFolding {
	GtkSourceGutterRendererPixbuf parent_instance;
	valaDevelopSourceGutterRendererFoldingPrivate * priv;
};

struct _valaDevelopSourceGutterRendererFoldingClass {
	GtkSourceGutterRendererPixbufClass parent_class;
};

struct _valaDevelopSourceGutterRendererFoldingPrivate {
	gchar* _full_path;
	GdkPixbuf* foldingEnabled;
	GdkPixbuf* foldingDisabled;
};

static gint valaDevelopSourceGutterRendererFolding_private_offset;
static gpointer vala_develop_source_gutter_renderer_folding_parent_class = NULL;

GType vala_develop_source_gutter_renderer_folding_get_type (void) G_GNUC_CONST;
#define VALA_DEVELOP_SOURCE_GUTTER_RENDERER_FOLDING_toolTipText _ ("Toggle folding")
valaDevelopSourceGutterRendererFolding* vala_develop_source_gutter_renderer_folding_new (void);
valaDevelopSourceGutterRendererFolding* vala_develop_source_gutter_renderer_folding_construct (GType object_type);
static gboolean vala_develop_source_gutter_renderer_folding_real_query_tooltip (GtkSourceGutterRenderer* base,
                                                                         GtkTextIter* iter,
                                                                         GdkRectangle* area,
                                                                         gint x,
                                                                         gint y,
                                                                         GtkTooltip* tooltip);
static void vala_develop_source_gutter_renderer_folding_real_activate (GtkSourceGutterRenderer* base,
                                                                GtkTextIter* iter,
                                                                GdkRectangle* area,
                                                                GdkEvent* evnt);
static GdkEventButton* _vala_GdkEventButton_copy (GdkEventButton* self);
void vala_develop_globals_toggle_region (GtkTextIter* iter);
static void _vala_GdkEventButton_free (GdkEventButton* self);
static void vala_develop_source_gutter_renderer_folding_real_draw (GtkSourceGutterRenderer* base,
                                                            cairo_t* cr,
                                                            GdkRectangle* background_area,
                                                            GdkRectangle* cell_area,
                                                            GtkTextIter* start,
                                                            GtkTextIter* end,
                                                            GtkSourceGutterRendererState state);
static void _vala_GdkEvent_free (GdkEvent* self);
gboolean vala_develop_globals_rectangle_contains (GdkRectangle* rect,
                                                  gint x,
                                                  gint y);
GdkPixbuf* vala_develop_globals_get_EmptyImage (void);
static void vala_develop_source_gutter_renderer_folding_finalize (GObject * obj);

static inline gpointer
vala_develop_source_gutter_renderer_folding_get_instance_private (valaDevelopSourceGutterRendererFolding* self)
{
	return G_STRUCT_MEMBER_P (self, valaDevelopSourceGutterRendererFolding_private_offset);
}

valaDevelopSourceGutterRendererFolding*
vala_develop_source_gutter_renderer_folding_construct (GType object_type)
{
	valaDevelopSourceGutterRendererFolding * self = NULL;
	GdkPixbuf* _tmp0_ = NULL;
	GdkPixbuf* _tmp1_;
	gint _tmp2_;
	gint _tmp3_;
	gint _tmp4_;
	gint _tmp5_;
	GdkPixbuf* _tmp6_;
	GdkPixbuf* _tmp7_ = NULL;
	GdkPixbuf* _tmp8_;
	gint _tmp9_;
	gint _tmp10_;
	gint _tmp11_;
	gint _tmp12_;
	GdkPixbuf* _tmp13_;
	GError* _inner_error0_ = NULL;
	self = (valaDevelopSourceGutterRendererFolding*) g_object_new (object_type, NULL);
	gtk_source_gutter_renderer_set_size ((GtkSourceGutterRenderer*) self, 16);
	g_object_set ((GtkSourceGutterRenderer*) self, "yalign", 0.5f, NULL);
	g_object_set ((GtkSourceGutterRenderer*) self, "xalign", 0.5f, NULL);
	_tmp1_ = gdk_pixbuf_new_from_resource ("/valaDevelop/plus.svg.png", &_inner_error0_);
	_tmp0_ = _tmp1_;
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
		g_clear_error (&_inner_error0_);
		return NULL;
	}
	_tmp2_ = gtk_source_gutter_renderer_get_size ((GtkSourceGutterRenderer*) self);
	_tmp3_ = _tmp2_;
	_tmp4_ = gtk_source_gutter_renderer_get_size ((GtkSourceGutterRenderer*) self);
	_tmp5_ = _tmp4_;
	_tmp6_ = gdk_pixbuf_scale_simple (_tmp0_, (_tmp3_ / 3) * 4, (_tmp5_ / 3) * 4, GDK_INTERP_BILINEAR);
	_g_object_unref0 (self->priv->foldingEnabled);
	self->priv->foldingEnabled = _tmp6_;
	_tmp8_ = gdk_pixbuf_new_from_resource ("/valaDevelop/minus.svg.png", &_inner_error0_);
	_tmp7_ = _tmp8_;
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
		_g_object_unref0 (_tmp0_);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
		g_clear_error (&_inner_error0_);
		return NULL;
	}
	_tmp9_ = gtk_source_gutter_renderer_get_size ((GtkSourceGutterRenderer*) self);
	_tmp10_ = _tmp9_;
	_tmp11_ = gtk_source_gutter_renderer_get_size ((GtkSourceGutterRenderer*) self);
	_tmp12_ = _tmp11_;
	_tmp13_ = gdk_pixbuf_scale_simple (_tmp7_, (_tmp10_ / 3) * 4, (_tmp12_ / 3) * 4, GDK_INTERP_BILINEAR);
	_g_object_unref0 (self->priv->foldingDisabled);
	self->priv->foldingDisabled = _tmp13_;
	_g_object_unref0 (_tmp7_);
	_g_object_unref0 (_tmp0_);
	return self;
}

valaDevelopSourceGutterRendererFolding*
vala_develop_source_gutter_renderer_folding_new (void)
{
	return vala_develop_source_gutter_renderer_folding_construct (VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING);
}

static gboolean
vala_develop_source_gutter_renderer_folding_real_query_tooltip (GtkSourceGutterRenderer* base,
                                                                GtkTextIter* iter,
                                                                GdkRectangle* area,
                                                                gint x,
                                                                gint y,
                                                                GtkTooltip* tooltip)
{
	valaDevelopSourceGutterRendererFolding * self;
	gboolean result = FALSE;
	self = (valaDevelopSourceGutterRendererFolding*) base;
	g_return_val_if_fail (iter != NULL, FALSE);
	g_return_val_if_fail (area != NULL, FALSE);
	g_return_val_if_fail (tooltip != NULL, FALSE);
	gtk_tooltip_set_text (tooltip, _ ("Expand/Collapse"));
	result = TRUE;
	return result;
}

static GdkEventButton*
_vala_GdkEventButton_copy (GdkEventButton* self)
{
	return g_boxed_copy (gdk_event_get_type (), self);
}

static gpointer
__vala_GdkEventButton_copy0 (gpointer self)
{
	return self ? _vala_GdkEventButton_copy (self) : NULL;
}

static void
_vala_GdkEventButton_free (GdkEventButton* self)
{
	g_boxed_free (gdk_event_get_type (), self);
}

static void
vala_develop_source_gutter_renderer_folding_real_activate (GtkSourceGutterRenderer* base,
                                                           GtkTextIter* iter,
                                                           GdkRectangle* area,
                                                           GdkEvent* evnt)
{
	valaDevelopSourceGutterRendererFolding * self;
	GdkEventButton* evntButton = NULL;
	GdkEventButton* _tmp0_;
	GdkEventButton* _tmp1_;
	self = (valaDevelopSourceGutterRendererFolding*) base;
	g_return_if_fail (iter != NULL);
	g_return_if_fail (area != NULL);
	g_return_if_fail (evnt != NULL);
	_tmp0_ = __vala_GdkEventButton_copy0 ((GdkEventButton*) evnt);
	evntButton = _tmp0_;
	_tmp1_ = evntButton;
	if (_tmp1_ != NULL) {
		guint mouseButtonClicked = 0U;
		GdkEventButton* _tmp2_;
		gboolean _tmp3_ = FALSE;
		GdkEventButton* _tmp4_;
		GdkEventType _tmp5_;
		_tmp2_ = evntButton;
		mouseButtonClicked = _tmp2_->button;
		_tmp4_ = evntButton;
		_tmp5_ = _tmp4_->type;
		if (_tmp5_ == GDK_BUTTON_PRESS) {
			_tmp3_ = mouseButtonClicked == ((guint) 1);
		} else {
			_tmp3_ = FALSE;
		}
		if (_tmp3_) {
			GtkTextIter _tmp6_;
			_tmp6_ = *iter;
			vala_develop_globals_toggle_region (&_tmp6_);
		}
	}
	__vala_GdkEventButton_free0 (evntButton);
}

static gpointer
_g_object_ref0 (gpointer self)
{
	return self ? g_object_ref (self) : NULL;
}

static void
_vala_GdkEvent_free (GdkEvent* self)
{
	g_boxed_free (gdk_event_get_type (), self);
}

static void
vala_develop_source_gutter_renderer_folding_real_draw (GtkSourceGutterRenderer* base,
                                                       cairo_t* cr,
                                                       GdkRectangle* background_area,
                                                       GdkRectangle* cell_area,
                                                       GtkTextIter* start,
                                                       GtkTextIter* end,
                                                       GtkSourceGutterRendererState state)
{
	valaDevelopSourceGutterRendererFolding * self;
	GdkDisplay* display = NULL;
	GdkDisplay* _tmp0_;
	GdkDisplay* _tmp1_;
	GdkSeat* seat = NULL;
	GdkDisplay* _tmp2_;
	GdkSeat* _tmp3_;
	GdkSeat* _tmp4_;
	GdkDevice* device = NULL;
	GdkSeat* _tmp5_;
	GdkDevice* _tmp6_;
	GdkDevice* _tmp7_;
	gint x = 0;
	gint y = 0;
	GdkModifierType mask = 0;
	GtkTextView* _tmp8_;
	GtkTextView* _tmp9_;
	GdkWindow* _tmp10_;
	GdkDevice* _tmp11_;
	gint _tmp12_ = 0;
	gint _tmp13_ = 0;
	GdkModifierType _tmp14_ = 0;
	gint iterx = 0;
	gint itery = 0;
	GtkTextView* _tmp15_;
	GtkTextView* _tmp16_;
	gint _tmp17_ = 0;
	gint _tmp18_ = 0;
	GtkTextIter iter = {0};
	GtkTextView* _tmp19_;
	GtkTextView* _tmp20_;
	GtkTextIter _tmp21_ = {0};
	gboolean mark_list = FALSE;
	GtkTextBuffer* _tmp22_;
	GtkTextIter _tmp23_;
	GSList* _tmp24_;
	GSList* _tmp25_;
	gboolean _tmp26_;
	gboolean _tmp27_ = FALSE;
	GtkTextIter _tmp28_;
	GdkRectangle _tmp29_;
	GdkEvent* _tmp30_;
	GdkEvent* _tmp31_;
	gboolean _tmp32_;
	GdkRectangle _tmp39_;
	GdkRectangle _tmp40_;
	GtkTextIter _tmp41_;
	GtkTextIter _tmp42_;
	self = (valaDevelopSourceGutterRendererFolding*) base;
	g_return_if_fail (cr != NULL);
	g_return_if_fail (background_area != NULL);
	g_return_if_fail (cell_area != NULL);
	g_return_if_fail (start != NULL);
	g_return_if_fail (end != NULL);
	_tmp0_ = gdk_display_get_default ();
	_tmp1_ = _g_object_ref0 (_tmp0_);
	display = _tmp1_;
	_tmp2_ = display;
	_tmp3_ = gdk_display_get_default_seat (_tmp2_);
	_tmp4_ = _g_object_ref0 (_tmp3_);
	seat = _tmp4_;
	_tmp5_ = seat;
	_tmp6_ = gdk_seat_get_pointer (_tmp5_);
	_tmp7_ = _g_object_ref0 (_tmp6_);
	device = _tmp7_;
	_tmp8_ = gtk_source_gutter_renderer_get_view ((GtkSourceGutterRenderer*) self);
	_tmp9_ = _tmp8_;
	_tmp10_ = gtk_text_view_get_window (_tmp9_, GTK_TEXT_WINDOW_WIDGET);
	_tmp11_ = device;
	gdk_window_get_device_position (_tmp10_, _tmp11_, &_tmp12_, &_tmp13_, &_tmp14_);
	x = _tmp12_;
	y = _tmp13_;
	mask = _tmp14_;
	iterx = 0;
	itery = 0;
	_tmp15_ = gtk_source_gutter_renderer_get_view ((GtkSourceGutterRenderer*) self);
	_tmp16_ = _tmp15_;
	gtk_text_view_window_to_buffer_coords (_tmp16_, GTK_TEXT_WINDOW_WIDGET, x, y, &_tmp17_, &_tmp18_);
	iterx = _tmp17_;
	itery = _tmp18_;
	_tmp19_ = gtk_source_gutter_renderer_get_view ((GtkSourceGutterRenderer*) self);
	_tmp20_ = _tmp19_;
	gtk_text_view_get_iter_at_location (_tmp20_, &_tmp21_, iterx, itery);
	iter = _tmp21_;
	gtk_text_iter_backward_chars (start, gtk_text_iter_get_line_offset (start));
	_tmp22_ = gtk_text_iter_get_buffer (start);
	_tmp23_ = *start;
	_tmp24_ = gtk_source_buffer_get_source_marks_at_iter (G_TYPE_CHECK_INSTANCE_CAST (_tmp22_, gtk_source_buffer_get_type (), GtkSourceBuffer), &_tmp23_, "folding");
	_tmp25_ = _tmp24_;
	_tmp26_ = g_slist_length (_tmp25_) > ((guint) 0);
	(_tmp25_ == NULL) ? NULL : (_tmp25_ = (g_slist_free (_tmp25_), NULL));
	mark_list = _tmp26_;
	_tmp28_ = iter;
	_tmp29_ = *cell_area;
	_tmp30_ = gdk_event_new (GDK_MOTION_NOTIFY);
	_tmp31_ = _tmp30_;
	_tmp32_ = gtk_source_gutter_renderer_query_activatable ((GtkSourceGutterRenderer*) self, &_tmp28_, &_tmp29_, _tmp31_);
	__vala_GdkEvent_free0 (_tmp31_);
	if (_tmp32_) {
		GdkRectangle _tmp33_;
		_tmp33_ = *cell_area;
		_tmp27_ = vala_develop_globals_rectangle_contains (&_tmp33_, x, y);
	} else {
		_tmp27_ = FALSE;
	}
	if (_tmp27_) {
		GdkPixbuf* _tmp34_;
		_tmp34_ = self->priv->foldingDisabled;
		gtk_source_gutter_renderer_pixbuf_set_pixbuf ((GtkSourceGutterRendererPixbuf*) self, _tmp34_);
	} else {
		GdkPixbuf* _tmp35_ = NULL;
		if (mark_list) {
			GdkPixbuf* _tmp36_;
			_tmp36_ = self->priv->foldingEnabled;
			_tmp35_ = _tmp36_;
		} else {
			GdkPixbuf* _tmp37_;
			GdkPixbuf* _tmp38_;
			_tmp37_ = vala_develop_globals_get_EmptyImage ();
			_tmp38_ = _tmp37_;
			_tmp35_ = _tmp38_;
		}
		gtk_source_gutter_renderer_pixbuf_set_pixbuf ((GtkSourceGutterRendererPixbuf*) self, _tmp35_);
	}
	_tmp39_ = *background_area;
	_tmp40_ = *cell_area;
	_tmp41_ = *start;
	_tmp42_ = *end;
	GTK_SOURCE_GUTTER_RENDERER_CLASS (vala_develop_source_gutter_renderer_folding_parent_class)->draw ((GtkSourceGutterRenderer*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_source_gutter_renderer_pixbuf_get_type (), GtkSourceGutterRendererPixbuf), cr, &_tmp39_, &_tmp40_, &_tmp41_, &_tmp42_, state);
	_g_object_unref0 (device);
	_g_object_unref0 (seat);
	_g_object_unref0 (display);
}

static void
vala_develop_source_gutter_renderer_folding_class_init (valaDevelopSourceGutterRendererFoldingClass * klass,
                                                        gpointer klass_data)
{
	vala_develop_source_gutter_renderer_folding_parent_class = g_type_class_peek_parent (klass);
	g_type_class_adjust_private_offset (klass, &valaDevelopSourceGutterRendererFolding_private_offset);
	((GtkSourceGutterRendererClass *) klass)->query_tooltip = (gboolean (*) (GtkSourceGutterRenderer*, GtkTextIter*, GdkRectangle*, gint, gint, GtkTooltip*)) vala_develop_source_gutter_renderer_folding_real_query_tooltip;
	((GtkSourceGutterRendererClass *) klass)->activate = (void (*) (GtkSourceGutterRenderer*, GtkTextIter*, GdkRectangle*, GdkEvent*)) vala_develop_source_gutter_renderer_folding_real_activate;
	((GtkSourceGutterRendererClass *) klass)->draw = (void (*) (GtkSourceGutterRenderer*, cairo_t*, GdkRectangle*, GdkRectangle*, GtkTextIter*, GtkTextIter*, GtkSourceGutterRendererState)) vala_develop_source_gutter_renderer_folding_real_draw;
	G_OBJECT_CLASS (klass)->finalize = vala_develop_source_gutter_renderer_folding_finalize;
}

static void
vala_develop_source_gutter_renderer_folding_instance_init (valaDevelopSourceGutterRendererFolding * self,
                                                           gpointer klass)
{
	self->priv = vala_develop_source_gutter_renderer_folding_get_instance_private (self);
	self->priv->foldingEnabled = NULL;
	self->priv->foldingDisabled = NULL;
}

static void
vala_develop_source_gutter_renderer_folding_finalize (GObject * obj)
{
	valaDevelopSourceGutterRendererFolding * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, VALA_DEVELOP_TYPE_SOURCE_GUTTER_RENDERER_FOLDING, valaDevelopSourceGutterRendererFolding);
	_g_free0 (self->priv->_full_path);
	_g_object_unref0 (self->priv->foldingEnabled);
	_g_object_unref0 (self->priv->foldingDisabled);
	G_OBJECT_CLASS (vala_develop_source_gutter_renderer_folding_parent_class)->finalize (obj);
}

GType
vala_develop_source_gutter_renderer_folding_get_type (void)
{
	static volatile gsize vala_develop_source_gutter_renderer_folding_type_id__volatile = 0;
	if (g_once_init_enter (&vala_develop_source_gutter_renderer_folding_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (valaDevelopSourceGutterRendererFoldingClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) vala_develop_source_gutter_renderer_folding_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (valaDevelopSourceGutterRendererFolding), 0, (GInstanceInitFunc) vala_develop_source_gutter_renderer_folding_instance_init, NULL };
		GType vala_develop_source_gutter_renderer_folding_type_id;
		vala_develop_source_gutter_renderer_folding_type_id = g_type_register_static (gtk_source_gutter_renderer_pixbuf_get_type (), "valaDevelopSourceGutterRendererFolding", &g_define_type_info, 0);
		valaDevelopSourceGutterRendererFolding_private_offset = g_type_add_instance_private (vala_develop_source_gutter_renderer_folding_type_id, sizeof (valaDevelopSourceGutterRendererFoldingPrivate));
		g_once_init_leave (&vala_develop_source_gutter_renderer_folding_type_id__volatile, vala_develop_source_gutter_renderer_folding_type_id);
	}
	return vala_develop_source_gutter_renderer_folding_type_id__volatile;
}

